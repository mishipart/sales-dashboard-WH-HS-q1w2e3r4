<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Sales Dashboard</title>

  <!-- ê²€ìƒ‰ ë…¸ì¶œ ìµœì†Œí™” -->
  <meta name="robots" content="noindex,nofollow">

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: system-ui; background:#f5f7fb; margin:0; padding:20px; }
    h1 { margin-bottom:20px; }
    h2 { margin-top:40px; }
    .kpis { display:flex; gap:12px; flex-wrap:wrap; }
    .kpi { background:#eaf2ff; padding:14px 18px; border-radius:12px; min-width:140px; }
    canvas { max-width:100%; background:#fff; border-radius:12px; padding:12px; margin-top:10px; }
  </style>
</head>
<body>

<h1>ğŸ“Š ë°©ì†¡ ë§¤ì¶œ ëŒ€ì‹œë³´ë“œ</h1>

<div class="kpis" id="kpis"></div>

<h2>ë°©ì†¡ì±„ë„ë³„ ë‹¬ì„±ìœ¨</h2>
<canvas id="channelChart"></canvas>

<script>
/* ğŸ”½ ì—¬ê¸°ì— ë³¸ì¸ Apps Script ì›¹ì•± URL ë„£ê¸° */
const API_URL = "https://script.google.com/macros/s/AKfycbzpLQ2wcNZIuisAjsaDTxA_Lj1E5X6CWEeZffW0_PPdjHTAo7peoHig1UmzyvXbkLHUuw/exec";

async function loadSummary() {
  const res = await fetch(API_URL + "?action=summary");
  const d = await res.json();

  document.getElementById("kpis").innerHTML = `
    <div class="kpi">ë°©ì†¡íšŸìˆ˜<br><b>${d.ë°©ì†¡íšŸìˆ˜}</b></div>
    <div class="kpi">íŠ¹ì•½íšŸìˆ˜<br><b>${d.íŠ¹ì•½íšŸìˆ˜}</b></div>
    <div class="kpi">í‰ê· ë‹¬ì„±ìœ¨<br><b>${Math.round(d.í‰ê· ë‹¬ì„±ìœ¨ * 100)}%</b></div>
    <div class="kpi">ì‹œê°„ë‹¹ë§¤ì¶œ<br><b>${Math.round(d.ì‹œê°„ë‹¹ë§¤ì¶œ)}</b></div>
  `;
}

async function loadChannelChart() {
  const res = await fetch(API_URL + "?action=bar&by=ë°©ì†¡ì±„ë„&metric=ë‹¬ì„±ìœ¨&agg=mean");
  const d = await res.json();

  new Chart(document.getElementById("channelChart"), {
    ty
